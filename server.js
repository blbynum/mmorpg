// Import required libraries
require(__dirname + "/Resources/config.js");
const fs = require('fs');
const net = require('net');
require('./packet.js');


console.log('\n' +
    '██╗░░██╗░█████╗░███╗░░██╗░██████╗░██████╗░██╗░░░██╗░█████╗░░██████╗░██████╗\n' +
    '██║░░██║██╔══██╗████╗░██║██╔════╝░██╔══██╗╚██╗░██╔╝██╔══██╗██╔════╝██╔════╝\n' +
    '███████║███████║██╔██╗██║██║░░██╗░██████╔╝░╚████╔╝░███████║╚█████╗░╚█████╗░\n' +
    '██╔══██║██╔══██║██║╚████║██║░░╚██╗██╔══██╗░░╚██╔╝░░██╔══██║░╚═══██╗░╚═══██╗\n' +
    '██║░░██║██║░░██║██║░╚███║╚██████╔╝██║░░██║░░░██║░░░██║░░██║██████╔╝██████╔╝\n' +
    '╚═╝░░╚═╝╚═╝░░╚═╝╚═╝░░╚══╝░╚═════╝░╚═╝░░╚═╝░░░╚═╝░░░╚═╝░░╚═╝╚═════╝░╚═════╝░\n' +
    '\n' +
    '███╗░░░███╗███╗░░░███╗░█████╗░  ░██████╗███████╗██████╗░██╗░░░██╗███████╗██████╗░\n' +
    '████╗░████║████╗░████║██╔══██╗  ██╔════╝██╔════╝██╔══██╗██║░░░██║██╔════╝██╔══██╗\n' +
    '██╔████╔██║██╔████╔██║██║░░██║  ╚█████╗░█████╗░░██████╔╝╚██╗░██╔╝█████╗░░██████╔╝\n' +
    '██║╚██╔╝██║██║╚██╔╝██║██║░░██║  ░╚═══██╗██╔══╝░░██╔══██╗░╚████╔╝░██╔══╝░░██╔══██╗\n' +
    '██║░╚═╝░██║██║░╚═╝░██║╚█████╔╝  ██████╔╝███████╗██║░░██║░░╚██╔╝░░███████╗██║░░██║\n' +
    '╚═╝░░░░░╚═╝╚═╝░░░░░╚═╝░╚════╝░  ╚═════╝░╚══════╝╚═╝░░╚═╝░░░╚═╝░░░╚══════╝╚═╝░░╚═╝');

console.log(' █████   █████                                                      █████████                                  \n' +
    '░░███   ░░███                                                      ███░░░░░███                                 \n' +
    ' ░███    ░███   ██████   ████████    ███████ ████████  █████ ████ ░███    ░███   █████   █████                 \n' +
    ' ░███████████  ░░░░░███ ░░███░░███  ███░░███░░███░░███░░███ ░███  ░███████████  ███░░   ███░░                  \n' +
    ' ░███░░░░░███   ███████  ░███ ░███ ░███ ░███ ░███ ░░░  ░███ ░███  ░███░░░░░███ ░░█████ ░░█████                 \n' +
    ' ░███    ░███  ███░░███  ░███ ░███ ░███ ░███ ░███      ░███ ░███  ░███    ░███  ░░░░███ ░░░░███                \n' +
    ' █████   █████░░████████ ████ █████░░███████ █████     ░░███████  █████   █████ ██████  ██████                 \n' +
    '░░░░░   ░░░░░  ░░░░░░░░ ░░░░ ░░░░░  ░░░░░███░░░░░       ░░░░░███ ░░░░░   ░░░░░ ░░░░░░  ░░░░░░                  \n' +
    '                                    ███ ░███            ███ ░███                                               \n' +
    '                                   ░░██████            ░░██████                                                \n' +
    '                                    ░░░░░░              ░░░░░░                                                 \n' +
    ' ██████   ██████ ██████   ██████    ███████        █████████                                                   \n' +
    '░░██████ ██████ ░░██████ ██████   ███░░░░░███     ███░░░░░███                                                  \n' +
    ' ░███░█████░███  ░███░█████░███  ███     ░░███   ░███    ░░░   ██████  ████████  █████ █████  ██████  ████████ \n' +
    ' ░███░░███ ░███  ░███░░███ ░███ ░███      ░███   ░░█████████  ███░░███░░███░░███░░███ ░░███  ███░░███░░███░░███\n' +
    ' ░███ ░░░  ░███  ░███ ░░░  ░███ ░███      ░███    ░░░░░░░░███░███████  ░███ ░░░  ░███  ░███ ░███████  ░███ ░░░ \n' +
    ' ░███      ░███  ░███      ░███ ░░███     ███     ███    ░███░███░░░   ░███      ░░███ ███  ░███░░░   ░███     \n' +
    ' █████     █████ █████     █████ ░░░███████░     ░░█████████ ░░██████  █████      ░░█████   ░░██████  █████    \n' +
    '░░░░░     ░░░░░ ░░░░░     ░░░░░    ░░░░░░░        ░░░░░░░░░   ░░░░░░  ░░░░░        ░░░░░     ░░░░░░  ░░░░░     \n' +
    '                                                                                                               \n' +
    '                                                                                                               \n' +
    '                                                                                                               ');

console.log((' __  __                                           ______                     \n' +
    '/\\ \\/\\ \\                                         /\\  _  \\                    \n' +
    '\\ \\ \\_\\ \\     __      ___      __   _ __   __  __\\ \\ \\L\\ \\    ____    ____   \n' +
    ' \\ \\  _  \\  /\'__`\\  /\' _ `\\  /\'_ `\\/\\`\'__\\/\\ \\/\\ \\\\ \\  __ \\  /\',__\\  /\',__\\  \n' +
    '  \\ \\ \\ \\ \\/\\ \\L\\.\\_/\\ \\/\\ \\/\\ \\L\\ \\ \\ \\/ \\ \\ \\_\\ \\\\ \\ \\/\\ \\/\\__, `\\/\\__, `\\ \n' +
    '   \\ \\_\\ \\_\\ \\__/.\\_\\ \\_\\ \\_\\ \\____ \\ \\_\\  \\/`____ \\\\ \\_\\ \\_\\/\\____/\\/\\____/ \n' +
    '    \\/_/\\/_/\\/__/\\/_/\\/_/\\/_/\\/___L\\ \\/_/   `/___/> \\\\/_/\\/_/\\/___/  \\/___/  \n' +
    '                               /\\____/         /\\___/                        \n' +
    '                               \\_/__/          \\/__/                         \n' +
    '                  _____       ____                                           \n' +
    ' /\'\\_/`\\  /\'\\_/`\\/\\  __`\\    /\\  _`\\                                         \n' +
    '/\\      \\/\\      \\ \\ \\/\\ \\   \\ \\,\\L\\_\\     __   _ __   __  __     __   _ __  \n' +
    '\\ \\ \\__\\ \\ \\ \\__\\ \\ \\ \\ \\ \\   \\/_\\__ \\   /\'__`\\/\\`\'__\\/\\ \\/\\ \\  /\'__`\\/\\`\'__\\\n' +
    ' \\ \\ \\_/\\ \\ \\ \\_/\\ \\ \\ \\_\\ \\    /\\ \\L\\ \\/\\  __/\\ \\ \\/ \\ \\ \\_/ |/\\  __/\\ \\ \\/ \n' +
    '  \\ \\_\\\\ \\_\\ \\_\\\\ \\_\\ \\_____\\   \\ `\\____\\ \\____\\\\ \\_\\  \\ \\___/ \\ \\____\\\\ \\_\\ \n' +
    '   \\/_/ \\/_/\\/_/ \\/_/\\/_____/    \\/_____/\\/____/ \\/_/   \\/__/   \\/____/ \\/_/ \n' +
    '                                                                             \n' +
    '                                                                             '));

console.log('______  __                                    _______                  \n' +
    '___  / / /_____ ______________ ____________  ____    |______________   \n' +
    '__  /_/ /_  __ `/_  __ \\_  __ `/_  ___/_  / / /_  /| |_  ___/_  ___/   \n' +
    '_  __  / / /_/ /_  / / /  /_/ /_  /   _  /_/ /_  ___ |(__  )_(__  )    \n' +
    '/_/ /_/  \\__,_/ /_/ /_/_\\__, / /_/    _\\__, / /_/  |_/____/ /____/     \n' +
    '                       /____/         /____/                           \n' +
    '______  ________  _________     ________                               \n' +
    '___   |/  /__   |/  /_  __ \\    __  ___/______________   ______________\n' +
    '__  /|_/ /__  /|_/ /_  / / /    _____ \\_  _ \\_  ___/_ | / /  _ \\_  ___/\n' +
    '_  /  / / _  /  / / / /_/ /     ____/ //  __/  /   __ |/ //  __/  /    \n' +
    '/_/  /_/  /_/  /_/  \\____/      /____/ \\___//_/    _____/ \\___//_/     \n' +
    '                                                                       ');

console.log(' ___  ___  ________  ________   ________  ________      ___    ___ ________  ________   ________                   \n' +
    '|\\  \\|\\  \\|\\   __  \\|\\   ___  \\|\\   ____\\|\\   __  \\    |\\  \\  /  /|\\   __  \\|\\   ____\\ |\\   ____\\                  \n' +
    '\\ \\  \\\\\\  \\ \\  \\|\\  \\ \\  \\\\ \\  \\ \\  \\___|\\ \\  \\|\\  \\   \\ \\  \\/  / | \\  \\|\\  \\ \\  \\___|_\\ \\  \\___|_                 \n' +
    ' \\ \\   __  \\ \\   __  \\ \\  \\\\ \\  \\ \\  \\  __\\ \\   _  _\\   \\ \\    / / \\ \\   __  \\ \\_____  \\\\ \\_____  \\                \n' +
    '  \\ \\  \\ \\  \\ \\  \\ \\  \\ \\  \\\\ \\  \\ \\  \\|\\  \\ \\  \\\\  \\|   \\/  /  /   \\ \\  \\ \\  \\|____|\\  \\\\|____|\\  \\               \n' +
    '   \\ \\__\\ \\__\\ \\__\\ \\__\\ \\__\\\\ \\__\\ \\_______\\ \\__\\\\ _\\ __/  / /      \\ \\__\\ \\__\\____\\_\\  \\ ____\\_\\  \\              \n' +
    '    \\|__|\\|__|\\|__|\\|__|\\|__| \\|__|\\|_______|\\|__|\\|__|\\___/ /        \\|__|\\|__|\\_________\\\\_________\\             \n' +
    '                                                      \\|___|/                  \\|_________\\|_________|             \n' +
    '                                                                                                                   \n' +
    '                                                                                                                   \n' +
    ' _____ ______   _____ ______   ________          ________  _______   ________  ___      ___ _______   ________     \n' +
    '|\\   _ \\  _   \\|\\   _ \\  _   \\|\\   __  \\        |\\   ____\\|\\  ___ \\ |\\   __  \\|\\  \\    /  /|\\  ___ \\ |\\   __  \\    \n' +
    '\\ \\  \\\\\\__\\ \\  \\ \\  \\\\\\__\\ \\  \\ \\  \\|\\  \\       \\ \\  \\___|\\ \\   __/|\\ \\  \\|\\  \\ \\  \\  /  / | \\   __/|\\ \\  \\|\\  \\   \n' +
    ' \\ \\  \\\\|__| \\  \\ \\  \\\\|__| \\  \\ \\  \\\\\\  \\       \\ \\_____  \\ \\  \\_|/_\\ \\   _  _\\ \\  \\/  / / \\ \\  \\_|/_\\ \\   _  _\\  \n' +
    '  \\ \\  \\    \\ \\  \\ \\  \\    \\ \\  \\ \\  \\\\\\  \\       \\|____|\\  \\ \\  \\_|\\ \\ \\  \\\\  \\\\ \\    / /   \\ \\  \\_|\\ \\ \\  \\\\  \\| \n' +
    '   \\ \\__\\    \\ \\__\\ \\__\\    \\ \\__\\ \\_______\\        ____\\_\\  \\ \\_______\\ \\__\\\\ _\\\\ \\__/ /     \\ \\_______\\ \\__\\\\ _\\ \n' +
    '    \\|__|     \\|__|\\|__|     \\|__|\\|_______|       |\\_________\\|_______|\\|__|\\|__|\\|__|/       \\|_______|\\|__|\\|__|\n' +
    '                                                   \\|_________|                                                    \n' +
    '                                                                                                                   \n' +
    '                                                                                                                   ');

console.log('888 888                                               e Y8b                             \n' +
    '888 888  ,"Y88b 888 8e   e88 888 888,8, Y8b Y888P    d8b Y8b     dP"Y  dP"Y             \n' +
    '8888888 "8" 888 888 88b d888 888 888 "   Y8b Y8P    d888b Y8b   C88b  C88b              \n' +
    '888 888 ,ee 888 888 888 Y888 888 888      Y8b Y    d888888888b   Y88D  Y88D             \n' +
    '888 888 "88 888 888 888  "88 888 888       888    d8888888b Y8b d,dP  d,dP              \n' +
    '                          ,  88P           888                                          \n' +
    '                         "8",P"            888                                          \n' +
    '    e   e         e   e       e88 88e      dP"8                                         \n' +
    '   d8b d8b       d8b d8b     d888 888b    C8b Y  ,e e,  888,8, Y8b Y888P  ,e e,  888,8, \n' +
    '  e Y8b Y8b     e Y8b Y8b   C8888 8888D    Y8b  d88 88b 888 "   Y8b Y8P  d88 88b 888 "  \n' +
    ' d8b Y8b Y8b   d8b Y8b Y8b   Y888 888P    b Y8D 888   , 888      Y8b "   888   , 888    \n' +
    'd888b Y8b Y8b d888b Y8b Y8b   "88 88"     8edP   "YeeP" 888       Y8P     "YeeP" 888    \n' +
    '                                                                                        \n' +
    '                                                                                        ');

console.log('__/\\\\\\________/\\\\\\___________________________________________________________________________/\\\\\\\\\\\\\\\\\\______________________________                                           \n' +
    ' _\\/\\\\\\_______\\/\\\\\\_________________________________________________________________________/\\\\\\\\\\\\\\\\\\\\\\\\\\____________________________                                          \n' +
    '  _\\/\\\\\\_______\\/\\\\\\________________________________/\\\\\\\\\\\\\\\\___________________/\\\\\\__/\\\\\\__/\\\\\\/////////\\\\\\___________________________                                         \n' +
    '   _\\/\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\__/\\\\\\\\\\\\\\\\\\_____/\\\\/\\\\\\\\\\\\____/\\\\\\////\\\\\\__/\\\\/\\\\\\\\\\\\\\____\\//\\\\\\/\\\\\\__\\/\\\\\\_______\\/\\\\\\__/\\\\\\\\\\\\\\\\\\\\__/\\\\\\\\\\\\\\\\\\\\_                                        \n' +
    '    _\\/\\\\\\/////////\\\\\\_\\////////\\\\\\___\\/\\\\\\////\\\\\\__\\//\\\\\\\\\\\\\\\\\\_\\/\\\\\\/////\\\\\\____\\//\\\\\\\\\\___\\/\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\_\\/\\\\\\//////__\\/\\\\\\//////__                                       \n' +
    '     _\\/\\\\\\_______\\/\\\\\\___/\\\\\\\\\\\\\\\\\\\\__\\/\\\\\\__\\//\\\\\\__\\///////\\\\\\_\\/\\\\\\___\\///______\\//\\\\\\____\\/\\\\\\/////////\\\\\\_\\/\\\\\\\\\\\\\\\\\\\\_\\/\\\\\\\\\\\\\\\\\\\\_                                      \n' +
    '      _\\/\\\\\\_______\\/\\\\\\__/\\\\\\/////\\\\\\__\\/\\\\\\___\\/\\\\\\__/\\\\_____\\\\\\_\\/\\\\\\__________/\\\\_/\\\\\\_____\\/\\\\\\_______\\/\\\\\\_\\////////\\\\\\_\\////////\\\\\\_                                     \n' +
    '       _\\/\\\\\\_______\\/\\\\\\_\\//\\\\\\\\\\\\\\\\/\\\\_\\/\\\\\\___\\/\\\\\\_\\//\\\\\\\\\\\\\\\\__\\/\\\\\\_________\\//\\\\\\\\/______\\/\\\\\\_______\\/\\\\\\__/\\\\\\\\\\\\\\\\\\\\__/\\\\\\\\\\\\\\\\\\\\_                                    \n' +
    '        _\\///________\\///___\\////////\\//__\\///____\\///___\\////////___\\///___________\\////________\\///________\\///__\\//////////__\\//////////__                                   \n' +
    '__/\\\\\\\\____________/\\\\\\\\__/\\\\\\\\____________/\\\\\\\\_______/\\\\\\\\\\____________________/\\\\\\\\\\\\\\\\\\\\\\___________________________________________________________________________        \n' +
    ' _\\/\\\\\\\\\\\\________/\\\\\\\\\\\\_\\/\\\\\\\\\\\\________/\\\\\\\\\\\\_____/\\\\\\///\\\\\\________________/\\\\\\/////////\\\\\\_________________________________________________________________________       \n' +
    '  _\\/\\\\\\//\\\\\\____/\\\\\\//\\\\\\_\\/\\\\\\//\\\\\\____/\\\\\\//\\\\\\___/\\\\\\/__\\///\\\\\\_____________\\//\\\\\\______\\///__________________________________________________________________________      \n' +
    '   _\\/\\\\\\\\///\\\\\\/\\\\\\/_\\/\\\\\\_\\/\\\\\\\\///\\\\\\/\\\\\\/_\\/\\\\\\__/\\\\\\______\\//\\\\\\_____________\\////\\\\\\_____________/\\\\\\\\\\\\\\\\___/\\\\/\\\\\\\\\\\\\\___/\\\\\\____/\\\\\\_____/\\\\\\\\\\\\\\\\___/\\\\/\\\\\\\\\\\\\\__     \n' +
    '    _\\/\\\\\\__\\///\\\\\\/___\\/\\\\\\_\\/\\\\\\__\\///\\\\\\/___\\/\\\\\\_\\/\\\\\\_______\\/\\\\\\________________\\////\\\\\\________/\\\\\\/////\\\\\\_\\/\\\\\\/////\\\\\\_\\//\\\\\\__/\\\\\\____/\\\\\\/////\\\\\\_\\/\\\\\\/////\\\\\\_    \n' +
    '     _\\/\\\\\\____\\///_____\\/\\\\\\_\\/\\\\\\____\\///_____\\/\\\\\\_\\//\\\\\\______/\\\\\\____________________\\////\\\\\\____/\\\\\\\\\\\\\\\\\\\\\\__\\/\\\\\\___\\///___\\//\\\\\\/\\\\\\____/\\\\\\\\\\\\\\\\\\\\\\__\\/\\\\\\___\\///__   \n' +
    '      _\\/\\\\\\_____________\\/\\\\\\_\\/\\\\\\_____________\\/\\\\\\__\\///\\\\\\__/\\\\\\_______________/\\\\\\______\\//\\\\\\__\\//\\\\///////___\\/\\\\\\___________\\//\\\\\\\\\\____\\//\\\\///////___\\/\\\\\\_________  \n' +
    '       _\\/\\\\\\_____________\\/\\\\\\_\\/\\\\\\_____________\\/\\\\\\____\\///\\\\\\\\\\/_______________\\///\\\\\\\\\\\\\\\\\\\\\\/____\\//\\\\\\\\\\\\\\\\\\\\_\\/\\\\\\____________\\//\\\\\\______\\//\\\\\\\\\\\\\\\\\\\\_\\/\\\\\\_________ \n' +
    '        _\\///______________\\///__\\///______________\\///_______\\/////___________________\\///////////_______\\//////////__\\///______________\\///________\\//////////__\\///__________');
console.log('Node version: ' + process.version);

// Load Initializers
const init_files = fs.readdirSync(__dirname + "/Initializers");
init_files.forEach(function (initFile) {
    console.log('Loading Initializers: + ' + initFile);
    require(__dirname + "/Initializers/" + initFile);
})

// Load Models
const model_files = fs.readdirSync(__dirname + "/Models");
model_files.forEach(function (modelFile) {
    console.log('Loading Model: + ' + modelFile);
    require(__dirname + "/Models/" + modelFile);
})

// Load Map Data
maps = {};

const map_files = fs.readdirSync(config.data_paths.maps);
map_files.forEach(function (mapFile) {
    console.log('Loading Map: ' + mapFile);
    let map = require(config.data_paths.maps + "/" + mapFile);
    maps[map.room] = map;
})

net.createServer(function (socket) {

    console.log("socket connected")
    const c_inst = new require('./client.js');
    let thisClient = new c_inst();

    thisClient.socket = socket;
    thisClient.initiate();

    socket.on('error', thisClient.error);

    socket.on('end', thisClient.end);

    socket.on('data', thisClient.data);

}).listen(config.port);

console.log("Initialization Completed, Server running on port: " + config.port + " for environment: " + config.environment);


// 4. Initiate the server and listen to the internet
// all of server logic